OperationsCenter:
  Protocol: https
  CasC:
    Enabled: true
  JavaOpts:
    -Dcom.cloudbees.jenkins.cjp.installmanager.CJPPluginManager.enablePluginCatalogInOC=true
    -Dcom.cloudbees.masterprovisioning.kubernetes.KubernetesMasterProvisioning.deleteClaim=true
  ExtraGroovyConfiguration:
    bundles-sync.groovy: |
      def log = java.util.logging.Logger.getLogger('bundles-sync.groovy')
      def job = jenkins.model.Jenkins.get().getItem('casc-bundles-update')
      if (job) {
        log.info('Scheduling bundle sync job')
        def run = jenkins.model.Jenkins.get().getQueue().schedule(job)
        run.future.waitForStart()
        log.info('Bundle sync job starting')
        run.future.get()
        log.info('Bundle sync job completed')
      } else {
        log.warning('CasC bundles sync job does not yet exist')
      }
